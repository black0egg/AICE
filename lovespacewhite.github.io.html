<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>lovespacewhite.github.io</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="lovespacewhite.github.io" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://lovespacewhite.github.io/" />
<meta property="og:url" content="https://lovespacewhite.github.io/" />
<meta property="og:site_name" content="lovespacewhite.github.io" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="lovespacewhite.github.io" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"lovespacewhite.github.io","name":"lovespacewhite.github.io","url":"https://lovespacewhite.github.io/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=20777b88304e9904a756a63d4730f6dff3a9c477">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      

      <h1 id="lovespacewhitegithubio">lovespacewhite.github.io</h1>

<hr />

<h1 id="0-1command">[0-1.Command]</h1>

<h2 id="jupyter-notebook-명령어">Jupyter Notebook 명령어</h2>
<p>Shift + Enter : 셀실행 후, 아래셀 선택<br />
Alt + Enter : 셀실행 후, 아래 빈쉘 생성<br />
Ctrl + Enter : 셀실행<br />
A : 바깥에서 위쪽 빈쉘 생성<br />
B : 바깥에서 아래 빈쉘 생성<br />
dd : 바깥에서 해당쉘 삭제</p>

<hr />

<h1 id="0-2도구-불러오기">[0-2.도구 불러오기]</h1>

<h2 id="pandas-불러오고-pd로-정의">pandas 불러오고, pd로 정의</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</code></pre></div></div>

<h2 id="numpy-불러오고-np로-정의">numpy 불러오고, np로 정의</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<h2 id="seaborn-설치-및-불러오고-sns로-정의">seaborn 설치 및 불러오고, sns로 정의</h2>
<p>(!: 리눅스 프롬프트 명령어)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">seaborn</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 
</code></pre></div></div>

<h2 id="matplot-불러오고-plt로-정의">matplot 불러오고, plt로 정의</h2>
<p>(%: 주피터랩 명령어)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<h2 id="텐서플로-불러오고-tf로-정의">텐서플로 불러오고, tf로 정의</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<h2 id="텐서플로-케라스모델-및-기능-불러오기">텐서플로 케라스모델 및 기능 불러오기</h2>
<p>(시퀀스(히든레이어개수)/덴스(노드개수)/액티베이션/과적합방지기능 불러오기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Dropout</span>
</code></pre></div></div>

<h2 id="모델-sklearn에서-선형회귀모델linearregression-불러오기">[모델] sklearn에서, 선형회귀모델(LinearRegression) 불러오기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.family</span> <span class="kn">import</span> <span class="n">model</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</code></pre></div></div>

<h2 id="모델-sklearn에서-분류회귀모델logistic-regression-불러오기">[모델] sklearn에서, 분류회귀모델(Logistic Regression) 불러오기</h2>
<p>(설명: 분류모델 주로 활용)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>  
</code></pre></div></div>

<h2 id="모델-sklearn에서-랜덤포레스트-불러오기">[모델] sklearn에서, 랜덤포레스트 불러오기</h2>
<p>(설명: 의사결정나무 2개에서, 여러개를 더해 예측율을 높임)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</code></pre></div></div>

<h2 id="모델-sklearn에서-의사결정나무-불러오기">[모델] sklearn에서, 의사결정나무 불러오기</h2>
<p>(설명: 분류/회귀가능한 다재다능, 다소복잡한 데이터셋도 학습가능)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
</code></pre></div></div>

<h2 id="모델-adaboost">[모델] AdaBoost</h2>

<h2 id="모델-gbm-gradient-boost">[모델] GBM (Gradient Boost)</h2>

<h2 id="모델-xgboost">[모델] XGBoost</h2>
<p>(설명: GBM의 느림, 과적합 방지를 위해 Regulation만 추가, 리소스를 적게 먹으며 조기종료 제공)</p>

<h2 id="모델-svm-support-vector-machine">[모델] SVM (Support Vector Machine)</h2>

<h2 id="모델-auto-encoder">[모델] Auto Encoder</h2>

<h2 id="모델-cnn">[모델] CNN</h2>

<h2 id="모델-rnn">[모델] RNN</h2>

<h2 id="모델-lstm">[모델] LSTM</h2>

<h2 id="모델-transformer">[모델] Transformer</h2>

<h2 id="모델-ses-simple-exponential-smoothing">[모델] SES (Simple Exponential Smoothing)</h2>

<h2 id="모델-yolo">[모델] YOLO</h2>

<h2 id="모델-vgg">[모델] VGG</h2>

<hr />

<h1 id="1-1빅데이터-수집">[1-1.빅데이터 수집]</h1>

<h2 id="00000csv-데이터-로드">“00000.csv” 데이터 로드</h2>
<p>(cp949는 MS office에서 인코딩할때 쓰임)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="s">"./00000.csv"</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s">"cp949"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="커스텀-프레임웍에서-00000csv-데이터-로드-2">커스텀 프레임웍에서 “00000.csv” 데이터 로드 2</h2>
<p>(custom_framework.config.data_dir 폴더에서 불러옴)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="n">custom_framework</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s">"/00000.csv"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="파일위치-환경변수">파일위치 환경변수</h2>
<p>data 경로: custom_framework.config.data_dir<br />
workspace 경로: custom_framework.config.workspace_dir<br />
model 경로: custom_framework.config.model_dir<br />
log 경로: custom_framework.config.workspace_logs</p>

<h2 id="00000_finalcsv-데이터-저장-1">“00000_final.csv” 데이터 저장 1</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_csv</span> <span class="p">(</span><span class="s">"00000_final.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">false</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="00000_finalxlsx-엑셀로-저장-2">“00000_final.xlsx” 엑셀로 저장 2</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_excel</span> <span class="p">(</span><span class="s">"00000.xlsx"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h1 id="1-2빅데이터-분석">[1-2.빅데이터 분석]</h1>

<p>Column Names = 열<br />
index = 행<br />
value = 값</p>

<h2 id="df데이터--처음-위head아래tail-10개행을-보여주기">df데이터 / 처음 위(head)아래(tail) 10개행을 보여주기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span> <span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="df데이터--형태rowcolumn수-확인">df데이터 / 형태(row/column수) 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<h2 id="df데이터--컬럼내역-출력">df데이터 / 컬럼내역 출력</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<h2 id="df데이터--로우내역-출력">df데이터 / 로우내역 출력</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<h2 id="df데이터--자료구조-파악">df데이터 / 자료구조 파악</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">info</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<h2 id="df데이터--타입-확인">df데이터 / 타입 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">dtypes</span> 
</code></pre></div></div>

<h2 id="df데이터--통계정보">df데이터 / 통계정보</h2>
<p>mean(평균), std(분산), min/max(최소/최대값)<br />
※ df.describe( ).transpose( )</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">describe</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<h2 id="df데이터--상관관계-분석">df데이터 / 상관관계 분석</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<h2 id="데이터-뽑아오기">데이터 뽑아오기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">## x의 0번째 데이터 뽑아오기
</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">## x의 뒤에서 1번째 데이터 뽑아오기
</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>  <span class="c1">## x의 0~4번째까지 데이터 뽑아오기
</span><span class="n">x</span><span class="p">[:]</span>  <span class="c1">## x의 전체 데이터 뽑아오기
</span></code></pre></div></div>

<h2 id="df데이터--00000컬럼의-데이터-확인">df데이터 / “00000”컬럼의 데이터 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"00000"</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="df데이터--00000컬럼의-값분포-확인">df데이터 / “00000”컬럼의 값분포 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"00000"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="df데이터--00000칼럼의-값비율-확인">df데이터 / “00000”칼럼의 값비율 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"00000"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h1 id="1-3빅데이터-시각화">[1-3.빅데이터 시각화]</h1>

<h2 id="matplotlib-시각화-스캐터바챠트">[Matplotlib] 시각화 (스캐터,바챠트)</h2>
<p>영역 지정 : plt.figure()<br />
차트/값 지정 : plt.plot()<br />
시각화 출력 : plt.show()</p>

<h3 id="df데이터--00000칼럼-바차트-시각화-1-이산">df데이터 / “00000”칼럼, 바차트 시각화 1 (이산)</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"00000"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span> <span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<h3 id="df데이터--00000칼럼-바차트-시각화-2">df데이터 / “00000”칼럼, 바차트 시각화 2</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span> <span class="p">)[</span><span class="s">"00000"</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span> <span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="df데이터--ab칼럼-히스토그램-시각화-연속">df데이터 / “A.B”칼럼, 히스토그램 시각화 (연속)</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"A.B"</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"hist"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"00000"</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"hist"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="바-플롯">바 플롯</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="히스토그램">히스토그램</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="산점도">산점도</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="색깔별-산점도-시각화">색깔별 산점도 시각화</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">groups</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'variety'</span><span class="p">)</span>
<span class="n">groups</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span> <span class="p">:</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'A'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'B'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">group</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>  <span class="c1">## 범례 추가
</span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="선-그래프">선 그래프</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="seaborn-시각화-히트맵-통계">[Seaborn] 시각화 (히트맵, 통계)</h2>

<h3 id="카운트-플롯">카운트 플롯</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"A"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="박스-플롯">박스 플롯</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"A"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"B"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="조인트-플롯">조인트 플롯</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"A"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"B"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"hex"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="상관관계-히트맵">상관관계 히트맵</h3>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span> <span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  
</code></pre></div></div>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr</span> <span class="o">=</span> <span class="n">jiro_df</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>  <span class="c1">## corr함수로 상관계수 구하기
</span><span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1">## annotation 포함
</span></code></pre></div></div>

<hr />

<h1 id="1-4빅데이터-전처리">[1-4.빅데이터 전처리]</h1>
<p>최고빈번값(Most frequent), 중앙값(Median), 평균값(Mean), 상수값(Constant)</p>

<h2 id="입력데이터에서-제외">입력데이터에서 제외</h2>
<p>※ axis=0(행), axis=1(열)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">drop</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'A'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="누락데이터-처리">누락데이터 처리</h2>
<p>※ axis=0(행), axis=1(열)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">replace</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<hr />

<h1 id="결측치">결측치</h1>

<h2 id="df데이터--칼럼마다-결측치-여부-확인">df데이터 / 칼럼마다 결측치 여부 확인</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="결측치null데이터-처리">결측치(Null데이터) 처리</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dropna</span><span class="p">(</span> <span class="p">),</span> <span class="n">fillna</span><span class="p">(</span> <span class="p">)</span> 
</code></pre></div></div>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'float_A'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'float_A'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">##float_A열 결측치 0으로 채우기
</span></code></pre></div></div>

<h2 id="결측치-처리">결측치 처리</h2>
<p>missing(결측값수)<br />
“_“를 numpy의 null값(결측치)으로 변경</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"_"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">NaN</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="class-열의-결측치값-제외시키기">“Class” 열의 결측치값 제외시키기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">"class"</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="listwise-결측치-행-제외시키기">Listwise 결측치 행 제외시키기</h2>
<p>(행의 1개값이라도 NaN이면 제외)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="pairwise-결측치-행-제외시키기">Pairwise 결측치 행 제외시키기</h2>
<p>(행의 모든값이 NaN일때 제외)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s">"all"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="most-frequent최빈값-대체하여-채우기">Most frequent(최빈)값 대체하여 채우기</h3>
<p>(범주형데이터 주로사용)<br />
df데이터 / 모두</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">mode</span><span class="p">().</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>
<p>df데이터 / “A”칼럼 결측치를 해당칼럼 최빈값으로 채우기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"A"</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"A"</span><span class="p">].</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="mean평균-median중간값-대체하여-채우기">mean(평균), median(중간)값 대체하여 채우기</h2>
<p>(범주형데이터 주로사용)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">mean</span><span class="p">()[</span><span class="s">"C1"</span><span class="p">:</span><span class="s">"C2"</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="앞값ffill-뒷값backfill-대체하여-채우기">앞값(ffill), 뒷값(backfill) 대체하여 채우기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">"ffill"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="주변값과-상관관계로-선형-채우기">주변값과 상관관계로 선형 채우기</h2>
<p>(선형관계형 데이터에서 주로사용)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">interpolate</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h1 id="아웃라이어">아웃라이어</h1>

<h2 id="아웃라이어-제외">아웃라이어 제외</h2>
<p>Class열의 H값 제외후 변경</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df</span> <span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"class"</span><span class="p">]</span><span class="err">!</span> <span class="o">=</span> <span class="s">"H"</span><span class="p">)]</span>
</code></pre></div></div>

<h2 id="아웃라이어-변경">아웃라이어 변경</h2>
<p>Class열의 H값을 F값으로 변경</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"class"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"class"</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">"H"</span><span class="p">,</span> <span class="s">"F"</span><span class="p">)</span>
</code></pre></div></div>

<p>제거기준 = (Q3 + IQR * 1.5 보다 큰 값) &amp; (Q1 - IQR * 1.5 보다 작은 값)</p>

<p>가.Q1, Q3, IQR 정의
IQR = Q3(3사분위수)-Q1(1사분위수)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"Dividend"</span><span class="p">,</span><span class="s">"PBR"</span><span class="p">]].</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">Q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"Dividend"</span><span class="p">,</span><span class="s">"PBR"</span><span class="p">]].</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span><span class="o">-</span><span class="n">Q1</span>
</code></pre></div></div>
<p>나.변경</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IQR_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Q3</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">]</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Q1</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">]</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">[</span><span class="s">"Dividend"</span><span class="p">])]</span>
<span class="n">IQR_df</span> <span class="o">=</span> <span class="n">IQR_df</span><span class="p">[(</span><span class="n">IQR_df</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Q3</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">]</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">IQR_df</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Q1</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">]</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">[</span><span class="s">"PBR"</span><span class="p">])]</span>
<span class="n">IQR_df</span> <span class="o">=</span> <span class="n">IQR_df</span><span class="p">[[</span><span class="s">"Dividend"</span><span class="p">,</span><span class="s">"PBR"</span><span class="p">]]</span>
</code></pre></div></div>
<p>다.확인(박스플롯)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IQR_df</span><span class="p">.</span><span class="n">boxplot</span><span class="p">()</span>
<span class="n">IQR_df</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div></div>

<hr />

<h1 id="feature-engineering">Feature Engineering</h1>

<h2 id="비닝binning">비닝(Binning)</h2>
<p>연속형 변수를 범주형 변수로 만드는 방법</p>

<p>비닝 / cut :
(구간값으로 나누기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"avg_bill"</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"avg_bill"</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s">"bill_rating"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span>
                 <span class="n">df</span><span class="p">[</span><span class="s">"avg_bill"</span><span class="p">],</span>
                 <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">"avg_bill"</span><span class="p">].</span><span class="nb">max</span><span class="p">()],</span>
                 <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"low"</span><span class="p">,</span> <span class="s">"mid"</span><span class="p">,</span> <span class="s">"high"</span><span class="p">])</span>
<span class="k">print</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"bill_rating"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()]</span>
</code></pre></div></div>

<p>비닝 / qcut :
(구간개수로 나누기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"bill_rating"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">qcut</span><span class="p">(</span>
                 <span class="n">df</span><span class="p">[</span><span class="s">"avg_bill"</span><span class="p">],</span>
                 <span class="mi">3</span><span class="p">,</span>
                 <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">"low"</span><span class="p">,</span> <span class="s">"mid"</span><span class="p">,</span> <span class="p">;</span><span class="n">high</span><span class="s">"])
print (df["</span><span class="n">bill_rating</span><span class="s">"].value_counts()]
</span></code></pre></div></div>

<h2 id="스케일링scaling">스케일링(Scaling)</h2>
<p>데이터 단위크기를 맞춤으로서 표준화/정규화</p>

<p>Standard Scaling :<br />
평균을 0, 표준편차를 1로 맞추기 (데이터 이상치가 심할경우 사용)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_num</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"avg_bill"</span><span class="p">,</span> <span class="s">"A_bill"</span><span class="p">,</span> <span class="s">"B_bill"</span><span class="p">]]</span>
<span class="n">Standardization_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_num</span> <span class="o">-</span> <span class="n">df_num</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">df_num</span><span class="p">.</span><span class="n">std</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">X_train2</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train1</span><span class="p">)</span>  <span class="c1">## 정규분포화
</span><span class="n">X_train2</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train1</span><span class="p">)</span>  <span class="c1">## 표준화
</span></code></pre></div></div>

<p>Min-Max Scaling : 
모든 데이터를 0~1사이로 맞추기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">nomalization_df</span> <span class="o">=</span> <span class="n">df_num</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">nomalization_df</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">normalization_df</span><span class="p">[:])</span>
</code></pre></div></div>

<p>-</p>

<h1 id="라벨인코딩">라벨인코딩</h1>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s">'A'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lb</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'A'</span><span class="p">]</span>
<span class="n">df</span>
</code></pre></div></div>

<p>-</p>

<h1 id="원핫인코딩">원핫인코딩</h1>

<h2 id="카테고리형-데이터를-원핫인코딩으로-컬럼-작성">카테고리형 데이터를 원핫인코딩으로 컬럼 작성</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Gender"</span><span class="p">,</span> <span class="s">"Partner"</span><span class="p">,</span> <span class="s">"Dependents"</span><span class="p">,</span> <span class="s">"PhoneService"</span><span class="p">,</span>
 <span class="s">"MultipleLines"</span><span class="p">,</span> <span class="s">"InternetService"</span><span class="p">,</span> <span class="s">"OnlineSecurity"</span><span class="p">,</span>
 <span class="s">"OnlineBackup"</span><span class="p">,</span> <span class="s">"DeviceProtection"</span><span class="p">,</span> <span class="s">"TechSupport"</span><span class="p">,</span> <span class="s">"StreamingTV"</span><span class="p">,</span>
 <span class="s">"StreamingMovies"</span><span class="p">,</span> <span class="s">"Contract"</span><span class="p">,</span> <span class="s">"PaperlessBilling"</span><span class="p">,</span> <span class="s">"PaymentMethod"</span><span class="p">]</span>

<span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">dummies</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="카테고리형-데이터를-판다스로-쉽게-원핫인코딩">카테고리형 데이터를 판다스로 쉽게 원핫인코딩</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"AA"</span><span class="p">,</span><span class="s">"BB"</span><span class="p">]]</span>
<span class="n">one_hot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"class"</span><span class="p">])</span>
<span class="n">one_hot_df</span>
</code></pre></div></div>

<p>-</p>

<h1 id="ordinalencoding">OrdinalEncoding</h1>
<p>Categorical feature(범주형 특성)에 대한 순서형 코딩<br />
각 범주들을 특성으로 변경하지 않고, 그 안에서 1,2,3 등의 숫자로 변경<br />
범주가 너무 많아 one hot encoding을 하기 애매한 상황에서 이용</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">category_encoders</span> <span class="kn">import</span> <span class="n">OrdinalEncoder</span>
<span class="n">enc1</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">cols</span> <span class="o">=</span> <span class="s">"color"</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">enc1</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">df2</span>
</code></pre></div></div>

<hr />

<h1 id="기타-주요작업">기타 주요작업</h1>

<h2 id="토탈차지-공백을-0으로-변경후-소수점-숫자형float타입으로-변경">토탈차지 공백을 0으로 변경후, 소수점 숫자형(float타입)으로 변경</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"TotalCharge"</span><span class="p">].</span><span class="n">replace</span><span class="p">([</span><span class="s">" "</span><span class="p">],</span> <span class="p">[</span><span class="s">"0"</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"TotalCharge"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"TotalCharge"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="해지여부-yesno를-10의-정수형으로-변경">해지여부 Yes/No를 1,0의 정수형으로 변경</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"Churn"</span><span class="p">].</span><span class="n">replace</span><span class="p">([</span><span class="s">"Yes"</span><span class="p">,</span> <span class="s">"No"</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="새로운-뉴피처-추가">새로운 뉴피처 추가</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"new_feature"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"f_1"</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s">"f_2"</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="distinct-피처-제외-값종류수">distinct 피처 제외 (값종류수)</h2>
<p>distinct=1인 경우, 모든컬럼이 동일하므로 피처에서 제외</p>

<h2 id="편향값">편향값</h2>

<h2 id="순서인덱스는-의미의-유무에-따라-제외">순서(인덱스)는 의미의 유무에 따라 제외</h2>

<hr />

<h1 id="1-5세트-구성">[1-5.세트 구성]</h1>

<h2 id="트레이닝테스트-세트-나누기">트레이닝/테스트 세트 나누기</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
</code></pre></div></div>

<h2 id="xy데이터-설정하기">X,y데이터 설정하기</h2>
<p>‘Answer’ 칼럼이 y값/타겟/레이블</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Answer'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'Answer'</span><span class="p">].</span><span class="n">values</span>
</code></pre></div></div>

<h2 id="xy데이터-불러오기">X,y데이터 불러오기</h2>
<p>reshape(-1,1) 2차원배열 디자인포맷(reshape) 확장(-1은 알아서 넣으라는 뜻)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]).</span><span class="n">resharpe</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="테스트세트를-30로-분류하고-50번-랜덤하게-섞기">테스트세트를 30%로 분류하고, 50번 랜덤하게 섞기</h2>
<p>(y값이 골고루 분할되도록 stratify하게 분할)</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span>
  <span class="n">train_test_split</span>
  <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">데이터</span> <span class="n">정규화</span><span class="o">/</span><span class="n">스케일링</span><span class="p">)</span>  
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">help</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span> <span class="p">)</span>
<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h1 id="2학습모델--3최적화">[2.학습모델] ~ [3.최적화]</h1>

<h2 id="linearregression-모델-선형회귀">LinearRegression 모델 (선형회귀)</h2>

<p>가. 모델 선정</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<p>나. 테스트 핏</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>  
</code></pre></div></div>

<p>다. 예측</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">linearR_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<p>라. 확인</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<p>회귀예측 주요 성과지표</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</code></pre></div></div>

<hr />

<h2 id="logistic-regression-모델-분류회귀">Logistic Regression 모델 (분류회귀)</h2>

<p>가. 라이브러리 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
</code></pre></div></div>

<p>나. 데이터 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">custom_framework</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s">"/train.csv"</span><span class="p">)</span>
</code></pre></div></div>

<p>다. 세트 나누기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
                 <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"OOO"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">train</span><span class="p">[</span><span class="s">"OOO"</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<p>라. 모델링</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span> <span class="p">)</span>   
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">LogisticR_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">LogisticR_pred</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="의사결정나무decision-tree-선형회귀">의사결정나무(Decision Tree) (선형회귀)</h2>
<p>분류/회귀가능한 다재다능, 다소복잡한 데이터셋도 학습가능</p>

<p>가. 의사결정나무 라이브러리 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> 
</code></pre></div></div>

<p>나. 데이터셋(df) 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">dt_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'DecisionTree'</span><span class="p">,</span><span class="n">dt_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span> 
</code></pre></div></div>

<hr />

<h2 id="ensemble-기법">Ensemble 기법</h2>
<p>1) Bagging<br />
2) Boosting : 이전학습 잘못예측한 데이터에 가중치부여해 오차보완<br />
3) Stacking : 여러개 모델이 예측한 결과데이터 기반, final_estimator모델로 종합 예측수행
4) Weighted Blending : 각모델 예측값에 대해 weight 곱하여 최종 아웃풋계산</p>

<p>-</p>

<h2 id="xgboost">XGBoost</h2>

<p>(!는 리눅스 명령어)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">xgboost</span>

<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassfier</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">xgb_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'XGBoost'</span><span class="p">,</span><span class="n">xgb_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li></li>
</ul>

<h2 id="lightgbm">LightGBM</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">lightGBM</span>

<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">GBMClassfier</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">lgbm_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'lgbm'</span><span class="p">,</span><span class="n">lgbm_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<p>-</p>

<h2 id="knn-k-nearest-neighbor">KNN (K-Nearest Neighbor)</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KneighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">knn_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'K-Nearest Neighbor'</span><span class="p">,</span><span class="n">knn_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<p>-</p>

<h2 id="random-forest">Random Forest</h2>
<p>선형회귀모델 중 하나<br />
의사결정나무 2개에서, 여러개를 더해 예측율을 높임</p>

<p>가. 랜덤포레스트 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</code></pre></div></div>

<p>나. model 랜덤포레스트 선정</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span>
                 <span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="c1">##학습시 생성할 트리갯수
</span>                 <span class="n">max_depth</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="c1">##트리의 최대 깊이
</span>                 <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="c1">##난수 seed 설정
</span>                 <span class="p">...,</span>
                 <span class="n">criterion</span><span class="o">=</span><span class="s">"gini"</span><span class="p">,</span> <span class="c1">##분할 품질을 측정하는 기능(디폴트:gini)
</span>                 <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1">##내부노드를 분할하는데 필요한 최소샘플수
</span>                 <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">##리프노드에 있어야할 최소샘플수
</span>                 <span class="n">min_weight_fraction_leaf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="c1">##가중치가 부여된 min_samples_leaf에서의 샘플수 비율
</span>                 <span class="n">max_feature</span><span class="o">=</span><span class="s">"auto"</span><span class="p">)</span> <span class="c1">##각노드에서 분할에 사용할 특징의 최대수
</span></code></pre></div></div>

<p>다. 테스트 핏</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<p>라. 스코어</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<p>마. 예측</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rf_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>  
</code></pre></div></div>

<p>바. RMSE값 구하기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>  
</code></pre></div></div>

<hr />

<h2 id="딥러닝-모델">딥러닝 모델</h2>

<p>가. 케라스 초기화</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">keras</span><span class="p">.</span><span class="n">backend</span><span class="p">.</span><span class="n">clear_session</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<p>나. 모델 작성
30개의 features, 보통 연산효율을 위해 relu활용<br />
Batchnormalization 활용<br />
과적합 방지<br />
input layer(30features), 2 hidden layer, output layer(이진분류)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span> <span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">(</span> <span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">(</span> <span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"sigmoid"</span><span class="p">))</span>
<span class="c1">#### 또는 output layer ()
</span></code></pre></div></div>

<p>(※ 아웃풋1(이진분류) = sigmoid, 아웃풋3(다중분류), softmax)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"softmax"</span><span class="p">))</span>
</code></pre></div></div>

<p>다.컴파일</p>

<p>이진분류 모델 (binary_crossentropy)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">"adam"</span><span class="p">,</span>
                       <span class="n">loss</span><span class="o">=</span><span class="s">"binary_crossentropy"</span><span class="p">,</span>
                       <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">"accuracy"</span><span class="p">])</span>
</code></pre></div></div>

<p>다중분류 모델 (categorical_crossentropy) (원핫인코딩 된 경우)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">"adam"</span><span class="p">,</span>
                       <span class="n">loss</span><span class="o">=</span><span class="s">"categorical_crossentropy"</span><span class="p">,</span>
                       <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">"accuracy"</span><span class="p">])</span>
</code></pre></div></div>

<p>다중분류 모델 (sparse_categorical_crossentropy) (원핫인코딩 안된 경우)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">"adam"</span><span class="p">,</span>
                       <span class="n">loss</span><span class="o">=</span><span class="s">"sparse_categorical_crossentropy"</span><span class="p">,</span>
                       <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">"accuracy"</span><span class="p">])</span>
</code></pre></div></div>

<p>예측 모델</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">"adam"</span><span class="p">,</span>
                       <span class="n">loss</span><span class="o">=</span><span class="s">"mse"</span><span class="p">)</span>
</code></pre></div></div>

<p>마. 딥러닝 테스트 핏</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">,</span> <span class="n">check_point</span><span class="p">])</span>
</code></pre></div></div>

<p>조기종료 옵션
(케라스 조기종료&amp;체크포인트 불러오기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span><span class="p">,</span> <span class="n">ModelCheckpoint</span>
</code></pre></div></div>

<p>(조기종료 : 로스값이 올라가면(5번까지는 괜찮음) 조기종료하기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s">"val_loss"</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">"min"</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<p>(체크포인트 : 최적 로스값을 기억(best_model.h5)하여 불러오기)</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">check_point</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s">"best_model.h5"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">monitor</span><span class="o">=</span><span class="s">"val_loss"</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">"min"</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>바. 학습과정 로그(loss,accuracy) history에 선언하여 남기기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">,</span> <span class="n">check_point</span><span class="p">])</span>
</code></pre></div></div>

<p>사. 학습로그 시각화 확인</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">"accuracy"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">"val_accuracy"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Accuracy"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Epochs"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Accuracy"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">"train_acc"</span><span class="p">,</span> <span class="s">"val_acc"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">(</span> <span class="p">)</span>
</code></pre></div></div>

<p>아. 딥러닝 성능평가</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">losses</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">losses</span><span class="p">[[</span><span class="s">"loss"</span><span class="p">,</span> <span class="s">"val_loss"</span><span class="p">]].</span><span class="n">plot</span><span class="p">(</span> <span class="p">)</span>

<span class="n">frome</span> <span class="n">sklearn</span><span class="p">.</span><span class="n">metrics</span> <span class="kn">import</span> <span class="nn">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">confustion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predictions</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="rnn">RNN</h2>

<p>RNN 모델링</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span>

<span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="p">.</span><span class="n">shape</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="p">.</span><span class="n">shape</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span><span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span><span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span>
 <span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
 <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span>  <span class="c1">## 이진분류 : binary_crossentropy
</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>


<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
 <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
 <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
 <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">),</span>
 <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFream</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">losses</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">losses</span><span class="p">[[</span><span class="s">'loss'</span><span class="p">,</span><span class="s">'val_loss'</span><span class="p">]].</span><span class="n">plot</span><span class="p">()</span>

<span class="n">losses</span><span class="p">[[</span><span class="s">'loss'</span><span class="p">,</span><span class="s">'val_loss'</span><span class="p">,</span><span class="s">'accuracy'</span><span class="p">,</span><span class="s">'val_accuracy'</span><span class="p">]].</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_accuracy'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Epochs'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Acc'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'acc'</span><span class="p">,</span><span class="s">'val_acc'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="cnn">CNN</h2>

<p>가. 이미지 불러오기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="n">FILENAME</span> <span class="o">=</span> <span class="s">'dataset-new_old.zip'</span>
<span class="n">glob</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="s">'IMAGE'</span><span class="p">)</span> <span class="p">:</span>
 <span class="err">!</span><span class="n">mkdir</span> <span class="n">IMAGE</span>
 <span class="err">!</span><span class="n">cp</span> <span class="n">dataset</span><span class="o">-</span><span class="n">new_old</span><span class="p">.</span><span class="nb">zip</span> <span class="p">.</span><span class="o">/</span><span class="n">IMAGE</span>
 <span class="err">!</span><span class="n">cd</span> <span class="n">IMAGE</span> <span class="p">;</span> <span class="n">unzip</span> <span class="n">dataset</span><span class="o">-</span><span class="n">new_old</span><span class="p">.</span><span class="nb">zip</span>

<span class="n">new_img_path</span> <span class="o">=</span> <span class="s">'./IMAGE/new/plastic1.jpg'</span>
<span class="n">gfile</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">new_img_path</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">decode_image</span><span class="p">(</span><span class="n">gfile</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">image</span><span class="p">.</span><span class="n">shape</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">old_img_path</span> <span class="o">=</span> <span class="s">'./IMAGE/old/old_plastic1.jpg'</span>
<span class="n">gfile</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">old_img_path</span><span class="p">)</span>
<span class="n">image</span><span class="p">.</span><span class="n">shape</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">Data</span> <span class="n">Preprocess</span>

<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">## size
</span><span class="n">num_classes</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1">## new &amp; old
</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.image</span> <span class="kn">import</span> <span class="n">ImageDataGenerator</span>

<span class="n">training_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span>
 <span class="n">rescale</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span>
 <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span>  <span class="c1"># train set : 435*(1-0.2)=348)
</span>
<span class="n">test_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span>
 <span class="n">rescale</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span>
 <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span>  <span class="c1"># test set : 435*0.2 = 87)
</span></code></pre></div></div>
<p>나. 이미지 읽기, 배치, 셔플, 레이블링</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="p">.</span><span class="o">/</span><span class="n">IMAGE</span><span class="o">/</span><span class="p">.</span><span class="n">ipynb_checkpoints</span> 

<span class="n">training_generator</span>
<span class="n">training_datagen</span><span class="p">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
 <span class="s">',/IMAGE/'</span><span class="p">,</span>
 <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span>
 <span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span>  <span class="c1">## size
</span> <span class="n">class_mode</span> <span class="o">=</span> <span class="s">'catrgorical'</span><span class="p">,</span>  <span class="c1">## binary, categorical
</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
 <span class="n">subset</span> <span class="o">=</span><span class="s">'training'</span>  <span class="c1">## training, validation, validation_split 사용하므로 subset 지정
</span><span class="p">)</span>

<span class="n">test_generator</span>
<span class="n">test_datagen</span><span class="p">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
 <span class="s">',/IMAGE/'</span><span class="p">,</span>
 <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span>
 <span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span>  <span class="c1">## size
</span> <span class="n">class_mode</span> <span class="o">=</span> <span class="s">'catrgorical'</span><span class="p">,</span>  <span class="c1">## binary, categorical
</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
 <span class="n">subset</span> <span class="o">=</span><span class="s">'validation'</span>  <span class="c1">## training, validation, validation_split 사용하므로 subset 지정
</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">training_generator</span><span class="p">.</span><span class="n">class_indices</span><span class="p">)</span>

<span class="n">batch_samples</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">traning_generator</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s">'True Value : '</span><span class="n">batch_sample</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">batch_sample</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>다. CNN 모델링</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>  <span class="c1">## Feature extraction
</span><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>  <span class="c1">## Classfication
</span><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax))

model.summary()

model.compile(
 optimizer='</span><span class="n">adam</span><span class="s">',
 loss='</span><span class="n">categorical_crossentropy</span><span class="s">',  ## 이진분류
 metrics=['</span><span class="n">accuracy</span><span class="s">'])

history = model.fit(training_generator,
 epochs=3,
 steps_per_epoch = len(training_generator) / batch_size,
 validation_steps = len(test_generator) / batch_size,
 validation_data = test_generator,
 vervose = 1
)
</span></code></pre></div></div>
<p>라. 성능평가/시각화</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">losses</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Dataframe</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">losses</span> <span class="o">=</span> <span class="n">head</span><span class="p">()</span>

<span class="n">losses</span><span class="p">[[</span><span class="s">'loss'</span><span class="p">,</span><span class="s">'val_loss'</span><span class="p">]].</span><span class="n">plot</span><span class="p">()</span>

<span class="n">losses</span><span class="p">[[</span><span class="s">'loss'</span><span class="p">,</span><span class="s">'val_loss'</span><span class="p">,</span><span class="s">'accuracy'</span><span class="p">,</span><span class="s">'val_accuracy'</span><span class="p">]].</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_accuracy'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Epochs'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylable</span><span class="p">(</span><span class="s">'Acc'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'acc'</span><span class="p">,</span><span class="s">'val_acc'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>마. 예측하기</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_generator 샘플데이터 가져오기
# 배치사이즈 32 확인
</span><span class="n">batch_img</span><span class="p">,</span> <span class="n">batch_label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_generator</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">batch_img</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">batch_label</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># 4개 test 샘플이지미 그려보고 예측해보기
</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">batch_img</span><span class="p">,</span> <span class="n">batch_label</span><span class="p">)):</span>
 <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
 <span class="n">pred_t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'True Value:</span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s">, Pred Value:</span><span class="si">{</span><span class="n">pred_t</span><span class="si">}</span><span class="s">)
 plt.imshow(img)
 i = i + 1
</span></code></pre></div></div>

<hr />

<h2 id="stacking">Stacking</h2>
<p>개별모델이 예측한 데이터를 기반한 종합예측</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemle</span> <span class="kn">import</span> <span class="n">StackingRegressor</span><span class="p">,</span> <span class="n">StackingClassifier</span>

<span class="n">stack_models</span> <span class="o">=</span>
<span class="p">[(</span><span class="s">'LogisticRegression'</span><span class="p">,</span><span class="n">lg</span><span class="p">),(</span><span class="s">'KNN'</span><span class="p">,</span><span class="n">knn</span><span class="p">),(</span><span class="s">'DecisionTree'</span><span class="p">,</span><span class="n">dt</span><span class="p">)]</span>

<span class="n">stacking</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span>
 <span class="n">stack_models</span><span class="p">,</span> <span class="n">final_estimator</span><span class="o">=</span><span class="n">rfc</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">stacking</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">stacking_pred</span> <span class="o">=</span> <span class="n">stacking</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'Stacking Ensemble'</span><span class="p">,</span> <span class="n">stacking_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="weighted-blending">Weighted Blending</h2>
<p>각 모델 예측값에 대하여 weight를 곱하여 최종계산</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final_output</span> <span class="o">=</span> <span class="p">{</span>
 <span class="s">'DecisionTree'</span><span class="p">:</span><span class="n">dt_pred</span><span class="p">,</span>
 <span class="s">'randomforest'</span><span class="p">:</span><span class="n">rf_pred</span><span class="p">,</span>
 <span class="s">'xgb'</span><span class="p">:</span><span class="n">xgb_pred</span><span class="p">,</span>
 <span class="s">'lgbm'</span><span class="p">:</span><span class="n">lgbm_pred</span><span class="p">,</span>
 <span class="s">'stacking'</span><span class="p">:</span><span class="n">stacking_pred</span>
<span class="p">}</span>

<span class="n">final_prediction</span><span class="o">=</span>\
<span class="n">final_outputs</span><span class="p">[</span><span class="s">'DecisionTree'</span><span class="p">]</span><span class="o">*</span><span class="mf">0.1</span>\
<span class="o">+</span><span class="n">final_outputs</span><span class="p">[</span><span class="s">'randomforest'</span><span class="p">]</span><span class="o">*</span><span class="mf">0.2</span>\
<span class="o">+</span><span class="n">final_outputs</span><span class="p">[</span><span class="s">'xgb'</span><span class="p">]</span><span class="o">*</span><span class="mf">0.25</span>\
<span class="o">+</span><span class="n">final_outputs</span><span class="p">[</span><span class="s">'lgbm'</span><span class="p">]</span><span class="o">*</span><span class="mf">0.15</span>\
<span class="o">+</span><span class="n">final_outputs</span><span class="p">[</span><span class="s">'stacking'</span><span class="p">]</span><span class="o">*</span><span class="mf">0.3</span>\

<span class="n">final_prediction</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_prediction</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="c1">## 가중치값이 0.5 초과하면 1, 그렇지 않으면 0
</span>
<span class="n">accuracy_eval</span><span class="p">(</span><span class="s">'Weighted Blending'</span><span class="p">,</span> <span class="n">final_prediction</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h1 id="4성능평가">[4.성능평가]</h1>

<h2 id="목표">목표</h2>
<p>Loss(오차율) 낮추고, Accuracy(정확도) 높이기<br />
Error -&gt; Epochs이 많아질수록 줄어들어야 함<br />
Epoch 많아질수록, 오히려 TestSet Error 올라가는경우 생길때, 직전Stop<br />
학습시 조기종료(early stop) 적용되지 않았을 때는 개선여지가 있기에,<br />
배치사이즈나 에포크를 수정하여 개선할 수 있음</p>

<h2 id="좋은-모델">좋은 모델</h2>
<p>과적합(overfitting) : 선이 너무 복잡<br />
트레인 어큐러시만 높아지고, 벨리드 어큐러시는 높아지지 않을때 (트레인어큐러시에 맞춰짐)<br />
과소적합(underfitting) : 선이 너무 단순<br />
트레인/벨리드 어큐러시가 교차되지 않고 아직 수평선을 향해 갈때<br />
좋은모델 : 어느정도 따라가는 적당선<br />
트레인/벨리드 어큐러시가 수평선을 이어 서로 교차될때</p>

<h2 id="성능지표">성능지표</h2>
<p>오차행렬(Confusion Matrix) (분류모델에 주로 쓰임)</p>
<ul>
  <li>TP (True Positive)</li>
  <li>TN (True Negative)</li>
  <li>FP (False Positive)</li>
  <li>FN (False Negative)</li>
</ul>

<p>오차행렬 지표</p>
<ul>
  <li>정확도(Accuracy) = 맞춤(TP&amp;TN) / 전체(total)</li>
  <li>정밀도(Precision) = TP / TP + FP (예측한 클래스 중, 실제로 해당 클래스인 데이터 비율)</li>
  <li>재현율(Recall) = TP = TP + FN (실제 클래스 중, 예측한 클래스와 일치한 데이터 비율)</li>
  <li>F1점수(F1-score) = 2 * [1/{(1/Precision)+(1/Recall)}] (Precision과 Recall의 조화평균)</li>
  <li>Support = 각 클래스 실제 데이터수</li>
</ul>

<p>오차행렬 성능지표 쉽게확인</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<p>오차행렬 성능지표 확인</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="손실함수">손실함수</h2>
<p>회귀모델 손실함수(Loss Function)</p>
<ul>
  <li>MSE(Mean Squared Error) : 실제에서 예측값 차이를 제곱, 합하여 평균 (예측)</li>
  <li>MAE(Mean Absolute Error) : 실제값 빼기 예측값 절댓값의 평균</li>
  <li>CEE(Cross Entropy Error) : 예측결과가 빗나갈수록 더큰패널티 부여 (분류)</li>
</ul>

<p>분류모델 손실함수</p>
<ul>
  <li>Binary Cross Entropy (이진분류)</li>
  <li>Multi Class Classfication (다중분류)</li>
</ul>

<h2 id="주요-지표">주요 지표</h2>
<ul>
  <li>loss = MSE (학습시 사용한 loss function종류에 의해 결정) (작을수록 좋음)</li>
  <li>error = 실제값 빼기 예측값의 평균 (작을수록 좋음)</li>
  <li>MSE = 실제값 빼기 예측값 제곱의 평균 (작을수록 좋음)</li>
  <li>MAE = 실제값 빼기 예측값 절댓값의 평균 (작을수록 좋음)</li>
  <li>R2(결정계수) = 독립변수가 종속변수를 얼마나 잘설명하는지 (클수록 좋음)</li>
</ul>

<h2 id="rmse값-확인하기">RMSE값 확인하기</h2>

<hr />

<h1 id="5적용">[5.적용]</h1>

<hr />


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
